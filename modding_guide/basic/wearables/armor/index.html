<head>
   <link href='./../../../../css/styles.css' rel='stylesheet' type='text/css'>
   <link rel="icon" type="image/png" href='./../../../../images/favicon_logo_sh.png'>
   <link rel="apple-touch-icon" type="image/png" href='./../../../../images/favicon_logo_sh.png'>
   <link rel="icon" type="image/png" sizes="144x144" href='./../../../../images/favicon_logo_sh.png'>
   <title>Armor and hats</title>
   <meta http-equiv="refresh" content="0; URL=https://brunosupremo.github.io/modding_guide/index.html" />
</head>
<body id="documentation">
   <!-- the header of the page -->
   <div class="inner">
      <header>
<div class='logo'>
</div>
</header>
      <div id="content_wrapper">
         <aside class="sidebar">
   <nav>
      <ul>
      
      

   <li>
      <a href='./../../../.././index.html'>Stonehearth's Modding Guide</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/index.html'>Modding Guide</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/index.html'>Modding Essentials</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/managing/index.html'>Managing mods</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/managing/workshop/index.html'>Steam Workshop mods</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/managing/unmanaged/index.html'>Local mods</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/programming_languages/index.html'>Programming Languages</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/modding_scope/index.html'>What can be modded</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/tools/index.html'>Tools for modding</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/stonehearth/index.html'>The Stonehearth mod</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/json/index.html'>Small intro to JSON</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/manifest/index.html'>The manifest</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/entities_components/index.html'>Entities and components</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/mixins/index.html'>Mixins</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/mixintos_overrides/index.html'>Mixintos and overrides</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/removing/index.html'>Mixintypes</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/localization/index.html'>Localization</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/debugging/index.html'>How to debug your errors</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/debugtools/index.html'>Using debug tools</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/debugtools/debugtools_mod/index.html'>The debugtools mod</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/debugtools/default_console/index.html'>The default console</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/startermods/index.html'>Startermod example</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/essentials/shed/index.html'>How to save time with SHED</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/index.html'>Basic Modding</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/index.html'>Art Workflow</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/modeling/index.html'>Creating models</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/icons/index.html'>Creating 2D assets</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/index.html'>Creating effects</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/animations/index.html'>Animations</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/animations/anim_existing/index.html'>For existing entities</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/animations/anim_custom/index.html'>For custom entities</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/cubemitters/index.html'>Particle effects</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/animated_lights/index.html'>Light effects</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/art/vfx/other_effects/index.html'>Other effects</a>





</li>

   
   </ul>



</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/adding_items/index.html'>Adding new items</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/adding_items/entity_forms/index.html'>Entity Forms</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/adding_items/cloning_manually/index.html'>Adding items manually</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/adding_items/cloning_with_shed/index.html'>Adding items with SHED</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/adding_items/item_scale/index.html'>Changing the scale</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/catalog/index.html'>The catalog</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/generic_resources/index.html'>Generic resources</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/craftables/index.html'>Adding recipes</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/wearables/index.html'>Adding equipment</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/wearables/armor/index.html'>Armor and hats</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/wearables/weapons/index.html'>Weapons</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/storages/index.html'>Storage items</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/color_maps/index.html'>Color and material maps</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/color_maps/shaders/index.html'>Materials and shaders</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/customization/index.html'>Adding customizations</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/crops/index.html'>Adding crops</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/renewable_resources/index.html'>Renewable resources</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/plants/index.html'>Plants and trees</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/static_scenarios/index.html'>Static scenarios</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/static_scenarios/ore_veins/index.html'>Ore veins</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/static_scenarios/landmarks/index.html'>Landmarks</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/static_scenarios/nests_ruins/index.html'>Critter nests and ruins</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/misc_json/index.html'>Miscellaneous JSON</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/basic/misc_json/shops/index.html'>Loadouts and shops</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/basic/localization_mod/index.html'>Translating mods</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/index.html'>Intermediate Modding</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/regions/index.html'>Collision regions</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/regions/origins/index.html'>Origins</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/regions/collision_destination/index.html'>Collision and destination</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/building_parts/index.html'>Building parts</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/commands/index.html'>Adding commands</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/buffs/index.html'>Buffs</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/thoughts/index.html'>Thoughts</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/traits/index.html'>Traits</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/biomes/index.html'>Biomes</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/biomes/seasons_weather/index.html'>Seasons and weather</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/jobs/index.html'>Adding jobs</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/jobs/crafting_jobs/index.html'>Crafting jobs</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/jobs/combat_jobs/index.html'>Combat jobs</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/kingdoms/index.html'>Kingdoms</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/monsters/index.html'>Critters and monsters</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/campaigns/index.html'>Adding campaigns</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/campaigns/encounters/index.html'>Generic encounters</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/hotloading/index.html'>Hotloading mods</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/intermediate/testing/index.html'>Testing your mod</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/index.html'>Advanced Modding</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/logging/index.html'>User settings and logging</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/events/index.html'>Events</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/components_controllers/index.html'>Lua scripts</a>



   <ul>
   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/components_controllers/components_renderers/index.html'>Components</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/components_controllers/controllers/index.html'>Controllers</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/ai/index.html'>AI actions</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/services/index.html'>Services</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/call_handlers/index.html'>Call handlers</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/ui/index.html'>UI</a>





</li>

   
      

   <li>
      <a href='./../../../.././modding_guide/advanced/cpp/index.html'>C++ functions</a>





</li>

   
   </ul>



</li>

   
   </ul>



</li>

   
   </ul>



</li>

      </ul>
   </nav>
</aside>

         <div id="content">         
   <div class='page_title'>Armor and hats</div>
   <ul>
    <li><a href="#AddingArmor">Creating armor and outfits</a></li>
    <li><a href="#Hats">Creating headgear</a></li>
</ul>



<h2><a name="AddingArmor"></a>Creating armor and outfits</h2>


<p>Let's create a new armor for the footmen. As always, let's copy a similar item from the stonehearth mod into our mod, and modify the files. For example, copy <code>stonehearth/entities/armor/iron_mail</code>.</p>



<ol>
    <li><p>Rename the files. We're going to use the startermod_items magic armor as example here, so substitute any "iron_mail" to "magic_armor" (or whatever identifier you want for your armor).</p></li>
    <li><p>Import the model into the voxel editor of your choice and modify it. Make sure the <a href="../../art/modeling/index.html#LayerNames">matrices/layers are named correctly</a> before exporting it (otherwise the armor won't stick to the hearthling's body and won't animate) and remember to take a screenshot for the icon. The armor doesn't need to have all the body parts if you don't want to, so you can remove any matrix/layer that you don't want.</p></li>
    <li><p>Modify the JSON files. Let's start by modifying the magic_armor_iconic.json. Here we only have to update the reference to the QB model, the icon and the display_name / description.</p>

<p>  Now for magic_armor.json. These are the different components related to the equipment piece:</p>

<ul>
    <li><p><a name="ModelVariants"></a><strong>"model_variants": {...}</strong></p>

<pre><code>"model_variants": {
   "default": {
      "layer": "armor",
      "transparent": "false",
      "models": [
         "file(magic_armor.qb)"
      ]
   },
   "female": {
      "layer": "armor",
      "transparent": "false",
      "models": [
         "file(magic_armor_female.qb)"
      ]
   },
   ...
},
</code></pre>
<p>  Here we have several variants. The "default" one is for the male hearthling, the "female" one for the female. This way when females equip this armor, we can have a different QB model for them. We can also have model variants for the orcs, etc.</p>

<p>The <strong>"female"</strong> key comes from the female_N.json files inside <code>stonehearth/entities/humans/female</code>:</p>

<pre><code>"render_info": {
   "animation_table": "stonehearth:skeletons:humanoid:female",
   "model_variant": "female"
}
</code></pre>

<p>Males don't have this key defined, so they will get the <strong>"default"</strong> variant. <br/>
Orcs and rabbits also have model variants, defined in some files inside <code>stonehearth/entities/monsters/orcs/orc</code> and <code>stonehearth/entities/rabbit_biped</code>. Goblins don't have them, they have their own equipment pieces which we don't use for any other entities, so they use a default variant instead.</p>

<p>You can define your own variants for equipment pieces using that property in the render info of the corresponding entity.</p>

<ul>
    <li><p><a name="LayerGroup"></a><strong>"layer"</strong> : here we declare the layer of the outfit. These are the possible values:</p>

<pre><code>"skeleton" / "skin" / "hat" / "clothing" / "armor" / "cloak"
</code></pre>

<p>If no layer is specified, "skin" will be used.</p>

<p>These layers allow us to stack different models on top of each other, basically clothes over the body. Don't confuse it with the matrices/layers from the QB file, this "layer" just acts like a group / category.</p>

<p>Normally we won't use "skeleton" nor "skin". The rest of layer values, used with the transparency setting, will hide (or not) the part of the hearthling body that matches the matrix/layer names from the QB model.</p></li>
    <li><p><strong>"transparent"</strong> : if this property is not defined, by default it will be <strong>"true"</strong> (notice the quotes). When it's <strong>"false"</strong>, it will completely replace the <a href="../../art/modeling/index.html#LayerNames">body part</a> of the hearthling with this model (when we use a render type of "merge_with_model"). Useful for hats, to keep showing the hearthling's hair (e.g. for circlets), and for items like bracelets.</p>

    <p>All the matrices/layers of the QB model will be treated with the same transparency declared here. If you need different transparencies, you'll need to make separate items.</p></li>
</ul></li>
    <li><p><strong>"stonehearth:entity_forms" : {}</strong></p>

<pre><code>"stonehearth:entity_forms": {
   "iconic_form": "file(magic_armor_iconic.json)"
},
</code></pre>
<p>Here we only declare the iconic form, since this item should be equippable and restockable but not placeable.</p></li>
    <li><p><a name="EPComp"></a><strong>"stonehearth:equipment_piece" : {}</strong></p>

<pre><code>"stonehearth:equipment_piece": {
   "render_type": "merge_with_model",
   "slot": "torso",
   "ilevel": 7,
   "roles": [ "mail_wearer" ],
   "required_job_level": 4,
   "equip_effect": "stonehearth:effects:weapon_level_up"
}
</code></pre>

<p>Here we specify the properties of this equipment piece:</p>
<ul>
    <li><p><strong>"render_type"</strong> : we use "merge_with_model" because we want the armor to merge with the hearthling's body, we exported our QB model with the correct names for the layers. Since we set the transparency to "false" in the model_variants component, any part of the skin that might pop out of our armor will be hidden (as if the armor part replaced that body part).</p></li>
    <li><p><strong>"slot"</strong> : we use "torso", which is one of the predefined slots that the game uses. This way hearthlings can replace this armor with better ones.</p></li>
    <li><p><strong>"ilevel"</strong> : we use a value of 7, a bit higher than the ilevel of the iron_mail that we copied.</p></li>
</ul>

<p>  In the current implementation of the game, it's not possible to manually assing equipment to specific hearthlings. So if you want your item to be equipped, check the ilevel of the other items, taking into account the balancing.</p>

<ul>
    <li><p><strong>"roles"</strong> : we keep the "mail_wearer" role since we want this armor to be equipped only by footmen.</p></li>
    <li><p><strong>"required_job_level"</strong> : we'll use 4, so only footmen at level 4 or above will equip this item.</p></li>
    <li><p><strong>"equip_effect"</strong> : we reused the same effect that the other equippable items from the game use.</p></li>
</ul></li>
</ul>

<p>  <a name="ArmorData"></a>Inside the entity data, we have the armor data:</p>

<pre><code>"entity_data": {
   "stonehearth:combat:armor_data": {
      "base_damage_reduction": 8
   },
   ...
</code></pre>

<p>  For <strong>"stonehearth:combat:armor_data"</strong> we only have the property <strong>"base_damage_reduction"</strong>, which represents the defense of this armor.</p>

<p>  The final defense of the hearthling when in combat will vary depending on other items equipped, buffs/debuffs, etc.</p>

<p>  We can also change the rest of properties from the "entity_data" section.</p></li>
    <li><p>Add an alias to your manifest:</p>
<pre><code>"aliases": {
   "armor:magic_armor" : "file(entities/armor/magic_armor)"
}
</code></pre></li>
    <li><p>Test your new armor in the game:
    <img src="../../../../images/basic/wearables/armor.png" alt="armor"/></p></li>
</ol>



<h2><a name="Hats"></a>Creating headgear</h2>


<p>Most of the existing headgear can be found inside <code>stonehearth/entities/armor</code>.</p>



<p>You can have an outfit that's both the clothes and a hat, but then both of them will have to share the "transparent" setting from the model_variants component.</p>



<p>If you make the hat separately, then you can declare a different transparency for it.</p>



<ol>
    <li><p>For our example, we'll create a crown. Let's copy <code>stonehearth/entities/armor/bronze_helm</code> to our mod, or any other circlet/helmet.</p></li>
    <li><p>Let's edit the models. The layer/matrix must be named <strong>"hat"</strong>:
      <img src="../../../../images/basic/wearables/matrix_name.png" alt="matrix_name"/></p>

    <p>  We'll also edit the model for the iconic and take a screenshot for the icon.</p></li>
    <li><p>Now we edit the JSON files. For the iconic we adjust the model name. For magic_crown.json, we'll edit these properties:</p>

<ul>
    <li><p><a name="ModelVariantsHat"></a><strong>"model_variants": {...}</strong></p>

<pre><code>"model_variants": {
   "default": {
      "layer": "hat",
      "transparent": "true",
      "models": [
         "file(magic_crown.qb)"
      ]
   },
   "female": {
      "layer": "hat",
      "transparent": "true",
      "models": [
         "file(magic_crown_female.qb)"
      ]
   }
}
</code></pre>

<p>The <strong>"layer"</strong> will be "hat", so that our model gets merged on top of the body.</p>

<p>We'll set the <strong>"transparent"</strong> property to "true" (notice that it is a string, not a boolean).</p>

<p>We're using a render type of "merge_with_model" in the equipment component, our QB model's layer is named 'hat', and the layer that contains the upper part of the hearthling's hair is also named 'hat', so this transparency will make the hair be visible after merging the models.</p>

<p>If our headgear covers all the head (such as a helmet or an archer hood), we can set it to "false", which will completely hide the upper part of the hearthling's hair.</p>

<p>And last, we change the file names to point to our models.</p></li>
    <li><p><strong>"stonehearth:entity_forms" : {}</strong></p>
<pre><code>"stonehearth:entity_forms": {
   "iconic_form": "file(magic_crown_iconic.json)"
}
</code></pre>
<p>Here we only declare the iconic form, since this item should be equippable and restockable but not placeable.</p></li>
    <li><p><strong>"stonehearth:equipment_piece" : {}</strong></p>
<pre><code>"stonehearth:equipment_piece": {
   "render_type": "merge_with_model",
   "slot": "helmet",
   "ilevel": 2,
   "required_job_level": 1,
   "roles": [ "cleric_job" ],
   "equip_effect": "stonehearth:effects:weapon_level_up"
}
</code></pre>
<p>Here we have the same properties than for the <a href="#EPComp">armor</a> example above.</p>

<p>For the "render_type" we use "merge_with_model", our crown will go in the "helmet" slot. We make it only equippable by clerics (using the "cleric_job" role), we change the "ilevel" and "required_job_level", and we leave the default "equip_effect" as it is.</p></li>
</ul>

<p>  For the entity data, we'll edit the properties on the "stonehearth:net_worth" and "stonehearth:catalog" sections.</p>

<p>  Our crown will also add some defense, so we include the <strong>"stonehearth:combat:armor_data"</strong> entry inside "entity_data":</p>

<pre><code>    "stonehearth:combat:armor_data": {
       "base_damage_reduction": 1
    }
</code></pre>

<p>  This entry only has the "base_damage_reduction" property in it. The final defense value used in combat will also depend on other items that the hearthling has equipped, multiplier attributes from buffs, etc.</p></li>
    <li><p>Add an alias to your manifest:</p>
<pre><code>"aliases": {
   "armor:magic_crown" : "file(entities/armor/magic_crown)"
}
</code></pre></li>
    <li><p>Test your new headgear in the game. You might need to tweak the model several times if it's clipping too much with certain hairstyles, or if it's too high / low for the head:
    <img src="../../../../images/basic/wearables/hats.png" alt="hats"/></p></li>
</ol>
   
</div>
      </div>
      <footer>
</footer>
   </div>
</body>