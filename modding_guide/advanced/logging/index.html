<head>
   <link href='./../../../css/styles.css' rel='stylesheet' type='text/css'>
   <link rel="icon" type="image/png" href='./../../../images/favicon_logo_sh.png'>
   <link rel="apple-touch-icon" type="image/png" href='./../../../images/favicon_logo_sh.png'>
   <link rel="icon" type="image/png" sizes="144x144" href='./../../../images/favicon_logo_sh.png'>
   <title>User settings and logging</title>
   <meta http-equiv="refresh" content="0; URL=https://brunosupremo.github.io/modding_guide/index.html" />
</head>
<body id="documentation">
   <!-- the header of the page -->
   <div class="inner">
      <header>
<div class='logo'>
</div>
</header>
      <div id="content_wrapper">
         <aside class="sidebar">
   <nav>
      <ul>
      
      

   <li>
      <a href='./../../.././index.html'>Stonehearth's Modding Guide</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/index.html'>Modding Guide</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/essentials/index.html'>Modding Essentials</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/essentials/managing/index.html'>Managing mods</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/essentials/managing/workshop/index.html'>Steam Workshop mods</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/managing/unmanaged/index.html'>Local mods</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/programming_languages/index.html'>Programming Languages</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/modding_scope/index.html'>What can be modded</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/tools/index.html'>Tools for modding</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/stonehearth/index.html'>The Stonehearth mod</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/json/index.html'>Small intro to JSON</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/manifest/index.html'>The manifest</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/entities_components/index.html'>Entities and components</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/mixins/index.html'>Mixins</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/mixintos_overrides/index.html'>Mixintos and overrides</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/removing/index.html'>Mixintypes</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/localization/index.html'>Localization</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/debugging/index.html'>How to debug your errors</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/debugtools/index.html'>Using debug tools</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/essentials/debugtools/debugtools_mod/index.html'>The debugtools mod</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/debugtools/default_console/index.html'>The default console</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/startermods/index.html'>Startermod example</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/essentials/shed/index.html'>How to save time with SHED</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/index.html'>Basic Modding</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/index.html'>Art Workflow</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/modeling/index.html'>Creating models</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/icons/index.html'>Creating 2D assets</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/index.html'>Creating effects</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/animations/index.html'>Animations</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/animations/anim_existing/index.html'>For existing entities</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/animations/anim_custom/index.html'>For custom entities</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/cubemitters/index.html'>Particle effects</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/animated_lights/index.html'>Light effects</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/art/vfx/other_effects/index.html'>Other effects</a>





</li>

   
   </ul>



</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/adding_items/index.html'>Adding new items</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/adding_items/entity_forms/index.html'>Entity Forms</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/adding_items/cloning_manually/index.html'>Adding items manually</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/adding_items/cloning_with_shed/index.html'>Adding items with SHED</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/adding_items/item_scale/index.html'>Changing the scale</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/catalog/index.html'>The catalog</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/generic_resources/index.html'>Generic resources</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/craftables/index.html'>Adding recipes</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/wearables/index.html'>Adding equipment</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/wearables/armor/index.html'>Armor and hats</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/wearables/weapons/index.html'>Weapons</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/storages/index.html'>Storage items</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/color_maps/index.html'>Color and material maps</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/color_maps/shaders/index.html'>Materials and shaders</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/customization/index.html'>Adding customizations</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/crops/index.html'>Adding crops</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/renewable_resources/index.html'>Renewable resources</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/plants/index.html'>Plants and trees</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/static_scenarios/index.html'>Static scenarios</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/static_scenarios/ore_veins/index.html'>Ore veins</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/static_scenarios/landmarks/index.html'>Landmarks</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/static_scenarios/nests_ruins/index.html'>Critter nests and ruins</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/misc_json/index.html'>Miscellaneous JSON</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/basic/misc_json/shops/index.html'>Loadouts and shops</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/basic/localization_mod/index.html'>Translating mods</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/index.html'>Intermediate Modding</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/regions/index.html'>Collision regions</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/regions/origins/index.html'>Origins</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/regions/collision_destination/index.html'>Collision and destination</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/building_parts/index.html'>Building parts</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/commands/index.html'>Adding commands</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/buffs/index.html'>Buffs</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/thoughts/index.html'>Thoughts</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/traits/index.html'>Traits</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/biomes/index.html'>Biomes</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/biomes/seasons_weather/index.html'>Seasons and weather</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/jobs/index.html'>Adding jobs</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/jobs/crafting_jobs/index.html'>Crafting jobs</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/jobs/combat_jobs/index.html'>Combat jobs</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/kingdoms/index.html'>Kingdoms</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/monsters/index.html'>Critters and monsters</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/campaigns/index.html'>Adding campaigns</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/campaigns/encounters/index.html'>Generic encounters</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/hotloading/index.html'>Hotloading mods</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/intermediate/testing/index.html'>Testing your mod</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/index.html'>Advanced Modding</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/advanced/logging/index.html'>User settings and logging</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/events/index.html'>Events</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/components_controllers/index.html'>Lua scripts</a>



   <ul>
   
      

   <li>
      <a href='./../../.././modding_guide/advanced/components_controllers/components_renderers/index.html'>Components</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/components_controllers/controllers/index.html'>Controllers</a>





</li>

   
   </ul>



</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/ai/index.html'>AI actions</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/services/index.html'>Services</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/call_handlers/index.html'>Call handlers</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/ui/index.html'>UI</a>





</li>

   
      

   <li>
      <a href='./../../.././modding_guide/advanced/cpp/index.html'>C++ functions</a>





</li>

   
   </ul>



</li>

   
   </ul>



</li>

   
   </ul>



</li>

      </ul>
   </nav>
</aside>

         <div id="content">         
   <div class='page_title'>User settings and logging</div>
   <ul>
    <li><a href="#Configs">Adding custom flags to user_settings.json</a></li>
    <li><a href="#Logging">How to log from your code</a></li>
</ul>



<h2><a name="Configs"></a>Adding custom flags to user_settings.json</h2>


<p>We can add custom config variables to the <code>user_settings.json</code> file for our mod in Lua scripts, regardless of whether we add an option in the UI to change them from within the game or not.</p>



<p>They will appear inside a key from the <strong>"mods"</strong> section of the user_settings file (the key will be the namespace of our mod).</p>



<p>We can add them programmatically if we need to save the value, but if it's for debugging purposes we can simply write the value manually in the user settings to enable/disable the flag.</p>



<pre><code>  -- Saving the 'max_quantity' property in user settings with a value of 5
  radiant.util.set_config('max_quantity', 5)
</code></pre>

<p>To retrieve the value from our code, we'd do:</p>



<pre><code>  local max_qty = radiant.util.get_config('max_quantity', 1)
</code></pre>
<p>The value will be read from the mod that the scripts belongs to. If the game can't find the config string, the default value will be returned (the second parameter that we pass, normally a number, string or boolean).</p>



<p>If we need to set or get a config value of a different mod from within our mod, we can use these instead:</p>



<pre><code>  radiant.util.set_global_config('mods.other_mod.config_variable', 'custom_value')
  local auto_loot_enabled = radiant.util.get_global_config('mods.stonehearth.auto_loot', false)
</code></pre>

<p>For doing this from a Javascript file, take a look at <code>stonehearth/ui/shell/settings/settings.js</code>:</p>



<pre><code>  _updateGameplayTabPage: function() {
     var self = this;
     radiant.call('radiant:get_config', 'mods.stonehearth')
        .done(function (response) {
           var stonehearthOptions = response['mods.stonehearth'] || {};
           if (stonehearthOptions) {
              self.set('showHearthlingPaths', stonehearthOptions.show_hearthling_paths);
              // More code...
           }
        })
  }
</code></pre>

<h2><a name="Logging"></a>How to log from your code</h2>
<p>There are several ways to print text in the <code>stonehearth.log</code> file from our mod's Lua files.</p>



<p>First, at the top of your Lua file, create a logger and give it a unique tag:</p>



<pre><code>  local log = radiant.log.create_logger('tag_name')
</code></pre>

<p>To write to the log inside your Lua functions, invoke methods on the logger:</p>



<pre><code>  log:info('hello world')
</code></pre>

<p>We have multiple levels of logging. Here they are:</p>



<pre><code>  ALWAYS = 0,
  ERROR = 1,
  WARNING = 3,
  INFO = 5,
  DEBUG = 7,
  DETAIL = 8,
  SPAM = 9
</code></pre>

<p>All of these have a corresponding method on the logger:</p>



<pre><code>  log:detail('really fine grained logging information')
  log:error('OMG CRAZY IMPORTANT ERROR!')
</code></pre>

<p>You probably figured most of that out on your own. Here's the secret sauce.</p>



<p>To actually show stuff in your log, add a logging block to your <code>user_settings.json</code> (at the same level than your user_id):</p>



<pre><code>  "logging" : {
     "show_console" : true,
     "mods" : {
        "your_mod_namespace" : {
           "log_level" : 1,
           "tag_name" : 5
        }
     }
  },
</code></pre>

<p>The <strong>show_console</strong> flag will pop up a window showing the stonehearth.log at run time when your start the game.</p>



<p>Then we have a <strong>"mods"</strong> section, listing the different mods by namespace. Inside it we have the different log tags, and optionally a <strong>log_level</strong> flag, which is the default logging level to apply across the whole mod. For each tag we can define the log level that we want to use.</p>



<p>The idea is if your mod has several different logical features, you initialize a separate logger for each of them, with different tags. Then when you're debugging feature A vs. feature B, you can adjust the logging level in your user settings so your log isn't spammed with information that you don't care about.</p>



<p>Examples:</p>



<p>This will log ONLY <code>log:error('...')</code> entries from loggers created with the tag "feature_a":</p>



<pre><code>  "mods" : {
     "your_mod_namespace" : {
        "feature_a" : 1
     }
  }
</code></pre>
<p>This will log all log entries from loggers created with the "feature_b" tag:</p>



<pre><code>  "mods" : {
     "your_mod_namespace" : {
        "feature_b" : 9
     }
  }
</code></pre>
<p>And of course this works:</p>



<pre><code>  "mods" : {
     "your_mod_namespace" : {
        "feature_a" : 1
        "feature_b" : 9
     }
  }
</code></pre>

<p><a name="Print"></a><img src="../../../images/common/gold.png" alt="icon"/> For quickly printing text to the stonehearth.log that you know you will remove before shipping your mod, you can also use the <code>print()</code> function:</p>



<pre><code>  print('debugging stuff')
  printf('debugging variables %d and %s', num_times, my_string)
</code></pre>

<p>These debug texts from the <code>print()</code> function will be shown preceded by a 'DEBUG' tag in the <code>stonehearth.log</code>, so you should be able to locate them quickly.</p>
   
</div>
      </div>
      <footer>
</footer>
   </div>
</body>